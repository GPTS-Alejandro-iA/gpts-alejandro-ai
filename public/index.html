<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Alejandro - Green Power Tech Store</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { 
      background: linear-gradient(135deg, #0f2b26 0%, #051b16 100%);
      height: 100vh; 
      display: flex; 
      align-items: flex-end; 
      justify-content: center; 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      padding: 10px;
    }
    #chat { 
      width: 100%; 
      max-width: 420px; 
      height: 92vh; 
      background: #0b141a; 
      border-radius: 24px; 
      overflow: hidden; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      display: flex; 
      flex-direction: column;
    }
    #header { 
      background: linear-gradient(135deg, #00a884, #008f6f); 
      color: white; 
      padding: 18px 16px; 
      display: flex; 
      align-items: center; 
      gap: 14px;
    }
    #avatar { 
      width: 48px; 
      height: 48px; 
      background: #00d95f; 
      border-radius: 50%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 24px; 
      font-weight: bold;
    }
    #title { font-size: 18px; font-weight: 600; }
    #subtitle { font-size: 13px; opacity: 0.9; }
    #online { font-size: 12px; color: #7fffd4; margin-left:auto; }

    #messages { 
      flex: 1; 
      padding: 16px; 
      overflow-y: auto; 
      background: url('https://i.imgur.com/3v9v3uG.jpg') repeat;
      background-size: 400px;
      background-color: #0b141a;
    }
    .msg { 
      max-width: 78%; 
      margin: 8px 0; 
      padding: 10px 14px; 
      border-radius: 18px; 
      line-height: 1.45; 
      position: relative; 
      animation: fadeIn 0.3s ease;
      word-wrap: break-word;
    }
    .bot { 
      background: #ffffff; 
      align-self: flex-start; 
      border-bottom-left-radius: 4px; 
      box-shadow: 0 1px 3px rgba(0,0,0,0.15);
    }
    .user { 
      background: #005c4b; 
      color: white; 
      align-self: flex-end; 
      border-bottom-right-radius: 4px; 
    }
    .time { font-size: 11px; opacity: 0.7; margin-top: 4px; text-align: right; }

    #input-area { 
      background: #111b21; 
      padding: 10px 16px; 
      display: flex; 
      gap: 10px; 
      align-items: center;
    }
    #input { 
      flex: 1; 
      padding: 14px 18px; 
      background: #202c33; 
      color: white; 
      border: none; 
      border-radius: 30px; 
      font-size: 16px; 
      outline: none;
    }
    #send { 
      background: #00a884; 
      color: white; 
      border: none; 
      width: 50px; 
      height: 50px; 
      border-radius: 50%; 
      font-size: 22px; 
      cursor: pointer; 
      display: flex; 
      align-items: center; 
      justify-content: center;
      transition: 0.2s;
    }
    #send:hover { background: #008f6f; transform: scale(1.08); }

    @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:none; } }

    /* OCULTAR EL SALUDO AUTOM√ÅTICO DE OPENAI */
    .msg:nth-child(1):nth-last-child(-n+2) { display: none !important; }
  </style>
</head>
<body>
  <div id="chat">
    <div id="header">
      <div id="avatar">A</div>
      <div>
        <div id="title">Alejandro</div>
        <div id="subtitle">Green Power Tech Store</div>
      </div>
      <div id="online">en l√≠nea</div>
    </div>

    <div id="messages"></div>

    <div id="input-area">
      <input type="text" id="input" placeholder="Escribe tu mensaje..." autocomplete="off">
      <button id="send"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@openai/assistants@latest/dist/assistants.min.js"></script>
  <script>
    const messagesDiv = document.getElementById("messages");
    const input = document.getElementById("input");
    const send = document.getElementById("send");

    const assistant = new OpenAIAssistant({
      assistantId: "asst_XXXXXXXXXXXXXXXXXXXXXXXX", // ‚Üê PON AQU√ç TU ID REAL DEL ASSISTANT
      trigger: "none",                          // ‚Üê IMPORTANTE: evita saludo autom√°tico
      theme: "dark"
    });

    assistant.onMessage = (msg) => {
      const div = document.createElement("div");
      div.className = `msg ${msg.role === "assistant" ? "bot" : "user"}`;
      div.innerHTML = msg.content[0].text.value.replace(/\n/g, "<br>") +
        `<div class="time">${new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>`;
      messagesDiv.appendChild(div);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    };

    // SALUDO INICIAL CONTROLADO POR NOSOTROS (el del Prompt Maestro)
    setTimeout(() => {
      assistant.addMessage({
        role: "assistant",
        content: [{ type: "text", text: `¬°Hola! Soy Alejandro, experto en energ√≠a renovable de Green Power Tech Store üåû

Estoy aqu√≠ para orientarte sobre todos nuestros sistemas y ayudarte en el proceso de compra o preparaci√≥n de una cotizaci√≥n preliminar para solicitar financiamiento.

¬øCu√°l de nuestros sistemas te interesa conocer m√°s?

1. Energ√≠a Solar Fuera de la red para residencias o negocios
2. Backups de Alta Capacidad para apartamentos u oficinas` }]
      });
    }, 600);

    const enviar = () => {
      const texto = input.value.trim();
      if (!texto) return;
      assistant.addMessage({ role: "user", content: [{ type: "text", text: texto }] });
      input.value = "";
    };

    send.onclick = enviar;
    input.addEventListener("keypress", e => e.key === "Enter" && enviar());
  </script>
</body>
</html>
