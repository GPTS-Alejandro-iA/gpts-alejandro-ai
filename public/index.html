<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Alejandro - Green Power Tech Store</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:#0b141a;height:100vh;display:flex;align-items:flex-end;justify-content:center;padding:10px;}
  #chat{max-width:420px;width:100%;height:92vh;background:#0b141a;border-radius:24px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.6);display:flex;flex-direction:column;}
  #header{background:#00a884;color:white;padding:18px 16px;display:flex;align-items:center;gap:14px;}
  #avatar{width:48px;height:48px;background:#00d95f;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:bold;color:#000;}
  #messages{flex:1;padding:16px;overflow-y:auto;background:#111b21;background-image:url('https://web.whatsapp.com/img/bg-chat-tile-light_686b98c6939c0ba86e07449a02eda6c5.png');background-repeat:repeat;background-size:256px;}
  .msg{max-width:78%;margin:8px 0;padding:10px 14px;border-radius:18px;line-height:1.45;word-wrap:break-word;}
  .bot{background:rgba(255,255,255,0.95);color:#000;align-self:flex-start;border-bottom-left-radius:4px;}
  .user{background:#005c4b;color:white;align-self:flex-end;border-bottom-right-radius:4px;}
  .time{font-size:11px;opacity:0.7;margin-top:4px;text-align:right;}
  #input-area{background:#111b21;padding:10px 16px;display:flex;gap:10px;align-items:center;}
  #input{flex:1;padding:14px 18px;background:#202c33;color:white;border:none;border-radius:30px;font-size:16px;outline:none;}
  #send{background:#00a884;color:white;border:none;width:50px;height:50px;border-radius:50%;font-size:22px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
</style>
</head>
<body>
<div id="chat">
  <div id="header">
    <div id="avatar">A</div>
    <div><div style="font-size:18px;font-weight:600;">Alejandro</div><div style="font-size:13px;opacity:0.9;">Green Power Tech Store</div></div>
    <div style="margin-left:auto;font-size:12px;color:#7fffd4;">en línea</div>
  </div>
  <div id="messages">
    <div class="bot msg">
      ¡Hola! Soy Alejandro, experto en energía renovable de <strong>Green Power Tech Store</strong><br><br>
      Estoy aquí para orientarte y ayudarte a comprar hoy mismo.<br><br>
      ¿Qué sistema te interesa?<br>
      <strong>1.</strong> Energía Solar Fuera de la red<br>
      <strong>2.</strong> Backups de Alta Capacidad
      <div class="time">ahora</div>
    </div>
  </div>
  <div id="input-area">
    <input type="text" id="input" placeholder="Escribe tu mensaje..." autocomplete="off">
    <button id="send"><i class="fas fa-paper-plane"></i></button>
  </div>
</div>

<script>
  const msgs = document.getElementById("messages");
  const input = document.getElementById("input");
  const send = document.getElementById("send");
  const sessionId = Date.now();

  function add(text, type) {
    const div = document.createElement("div");
    div.className = "msg " + type;
    div.innerHTML = text.replace(/\n/g, "<br>") + `<div class="time">${new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>`;
    msgs.appendChild(div);
    msgs.scrollTop = msgs.scrollHeight;
  }

  async function enviar() {
    const txt = input.value.trim();
    if (!txt) return;
    add(txt, "user");
    input.value = "";
    const res = await fetch("/chat", { method: "POST", headers: {"Content-Type":"application/json"}, body: JSON.stringify({message: txt, sessionId}) });
    const data = await res.json();
    add(data.reply, "bot");
  }

  send.onclick = enviar;
  input.addEventListener("keypress", e => e.key === "Enter" && enviar());
</script>
</body>
</html>
